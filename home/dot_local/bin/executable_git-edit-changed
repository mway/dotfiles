#!/usr/bin/env bash

fzf_preview() {
	# Alternatively: 'bat --color=always --style=numbers --line-range :300 {}'
	fzf -m --height=30% -q "$1" --preview 'git show --color=always --format="" {} | tail -n +6'
}

# shellcheck disable=SC2086,SC2155
_fn() {
	readonly changed="$(git changed | fzf_preview "$1")"
	[ -z "$changed" ] || "$EDITOR" $changed
}

_fn "$@"
