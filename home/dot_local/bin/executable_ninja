#!/usr/bin/env bash
set -eo pipefail

# shellcheck disable=SC2155
_fn() {
  readonly name="ninja"
  local prog="$(mw path "$name" 2>/dev/null || true)"

  if [ -z "prog" ]; then
    echo "Error: could not detect binary path for ninja"
  fi
  prog="$(dirname "$prog")/ninja"

  readonly detected_version="$(mw version "$name" 2>/dev/null || true)"
  readonly version="${detected_version:-"1"}"
  if [[ "$("$prog" --version)" != *"$version"* ]]; then
	echo $prog $version
	echo "$($prog --version)"
	mw install ninja
  fi

  exec "${prog:-"/usr/bin/ninja"}" "$@"
}

_fn "$@"
