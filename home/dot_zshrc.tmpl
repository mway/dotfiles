#!/usr/bin/env zsh

zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}
zstyle ':completion:*' verbose yes file-sort modification
zstyle ':completion:*' completer _complete _ignored _approximate
zstyle ':completion:*' menu select
zstyle ':completion:*:*:git:*' script '{{ .path.profiled }}/40_completion_git.bash'
zstyle ':completion:*:*:just:*' script '{{ .path.config }}/zsh/funcs/_just'
zstyle :compinstall filename '{{ .path.home }}/.zshrc'

# zsh-z
if [ -f '{{ .path.local }}/share/zsh/zsh-z/zsh-z.plugin.zsh' ]; then
  source '{{ .path.local }}/share/zsh/zsh-z/zsh-z.plugin.zsh'
fi

# builtin/common autocomplete
fpath=('{{ .path.config }}/zsh/funcs' '{{ .path.local }}/share/zsh/autocomplete' $fpath)
if command -v brew >/dev/null 2>&1; then
  fpath+=("$(brew --prefix zsh)/share/zsh/functions" "$(brew --prefix)/share/zsh/site-functions")
fi

autoload -Uz compinit && compinit
autoload -U colors && colors

setopt HIST_EXPIRE_DUPS_FIRST
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_FIND_NO_DUPS
setopt HIST_SAVE_NO_DUPS
setopt EXTENDED_HISTORY
setopt INC_APPEND_HISTORY
export HISTTIMEFORMAT="[%F %T] "
export HISTSIZE=100000000

[ ! -f '{{ .path.home }}/.dotrc' ] || source '{{ .path.home }}/.dotrc'
[ ! -f '{{ .path.home }}/.dotrc.zsh' ] || source '{{ .path.home }}/.dotrc.zsh'
[ ! -f '{{ .path.home }}/.zshrc.local' ] || source '{{ .path.home }}/.zshrc.local'
